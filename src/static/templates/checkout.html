{% extends "base.html" %}

{% block title %}Checkout - {{ super() }}{% endblock %}

{% block content %}
<section class="section section-light">
    <h2>Complete Your Website Order</h2>
    <p>You're just a few steps away from your new professional website!</p>
</section>

<section class="section section-dark">
    <div class="checkout-container">
        <div class="checkout-summary">
            <h3>Order Summary</h3>
            <div class="template-preview">
                <img src="{{ url_for('static', filename=template.image_path) }}" alt="{{ template.name }}" class="template-image">
                <h4>{{ template.name }}</h4>
                <p>{{ template.description }}</p>
            </div>
            
            <div class="pricing-summary">
                <div class="price-item">
                    <span>One-time setup fee:</span>
                    <span>ZAR 1,500.00</span>
                </div>
                <div class="price-item">
                    <span>Monthly subscription:</span>
                    <span>ZAR 350.00</span>
                </div>
                <div class="price-item total">
                    <span>Today's total:</span>
                    <span>ZAR 1,850.00</span>
                </div>
            </div>
            
            <div class="subscription-details">
                <h4>Subscription Details</h4>
                <p>Your monthly subscription includes:</p>
                <ul>
                    <li>Website hosting and maintenance</li>
                    <li>Security updates and monitoring</li>
                    <li>Basic content updates (text and images)</li>
                    <li>Email support</li>
                </ul>
                <p><small>You can cancel your subscription at any time from your dashboard.</small></p>
            </div>
        </div>
        
        <div class="checkout-form">
            <h3>Business Information</h3>
            <form id="checkout-form" action="{{ url_for('checkout.process_order') }}" method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" name="template_id" value="{{ template.id }}">
                
                <div class="form-section">
                    <h4>Business Details</h4>
                    <div class="form-group">
                        <label for="business_name">Business Name</label>
                        <input type="text" id="business_name" name="business_name" value="{{ current_user.business_name }}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="business_description">Business Description</label>
                        <textarea id="business_description" name="business_description" rows="4" required></textarea>
                        <p class="form-help">Tell us about your business, products/services, and target audience.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="business_address">Business Address</label>
                        <input type="text" id="business_address" name="business_address" value="{{ current_user.address }}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="business_phone">Business Phone</label>
                        <input type="text" id="business_phone" name="business_phone" value="{{ current_user.phone }}" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="business_email">Business Email (for website contact)</label>
                        <input type="email" id="business_email" name="business_email" value="{{ current_user.email }}" required>
                    </div>
                </div>
                
                <div class="form-section">
                    <h4>Website Content Requirements</h4>
                    <div class="form-group">
                        <label for="website_pages">Pages Needed (select all that apply)</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="website_pages[]" value="home" checked> Home</label>
                            <label><input type="checkbox" name="website_pages[]" value="about"> About Us</label>
                            <label><input type="checkbox" name="website_pages[]" value="services"> Services/Products</label>
                            <label><input type="checkbox" name="website_pages[]" value="gallery"> Gallery</label>
                            <label><input type="checkbox" name="website_pages[]" value="testimonials"> Testimonials</label>
                            <label><input type="checkbox" name="website_pages[]" value="contact" checked> Contact</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="content_notes">Additional Content Notes</label>
                        <textarea id="content_notes" name="content_notes" rows="4"></textarea>
                        <p class="form-help">Any specific content requirements or preferences for your website.</p>
                    </div>
                    
                    <div class="form-group">
                        <label for="existing_website">Do you have an existing website?</label>
                        <select id="existing_website" name="existing_website">
                            <option value="no">No</option>
                            <option value="yes">Yes</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="existing_website_url_group" style="display: none;">
                        <label for="existing_website_url">Existing Website URL</label>
                        <input type="url" id="existing_website_url" name="existing_website_url">
                    </div>
                </div>
                
                <div class="form-section">
                    <h4>Payment Information</h4>
                    <div class="form-group">
                        <label for="card_number">Card Number</label>
                        <input type="text" id="card_number" name="card_number" placeholder="1234 5678 9012 3456" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group half">
                            <label for="expiry_date">Expiry Date</label>
                            <input type="text" id="expiry_date" name="expiry_date" placeholder="MM/YY" required>
                        </div>
                        
                        <div class="form-group half">
                            <label for="cvv">CVV</label>
                            <input type="text" id="cvv" name="cvv" placeholder="123" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="name_on_card">Name on Card</label>
                        <input type="text" id="name_on_card" name="name_on_card" required>
                    </div>
                </div>
                
                <div class="form-section">
                    <div class="form-group">
                        <label class="checkbox-container">
                            <input type="checkbox" name="terms_accepted" required>
                            I agree to the <a href="{{ url_for('main.terms_of_service') }}" target="_blank">Terms of Service</a> and <a href="{{ url_for('main.privacy_policy') }}" target="_blank">Privacy Policy</a>
                        </label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="cta-button">Complete Order</button>
                </div>
            </form>
        </div>
    </div>
</section>

<script>
    // Show/hide existing website URL field based on selection
    document.getElementById('existing_website').addEventListener('change', function() {
        var urlGroup = document.getElementById('existing_website_url_group');
        if (this.value === 'yes') {
            urlGroup.style.display = 'block';
        } else {
            urlGroup.style.display = 'none';
        }
    });
</script>
{% endblock %}
